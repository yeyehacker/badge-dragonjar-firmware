file(GLOB_RECURSE MININO_SOURCE_FILES "$ENV{MININO_PATH}/main/*")
file(GLOB_RECURSE LOCAL_SOURCE_FILES "./*")
set(all_src_files "")

foreach(file ${MININO_SOURCE_FILES})
Â  Â  get_filename_component(extension ${file} EXT)
Â  Â  # Exclude main.c from Minino
Â  Â  if(NOT extension STREQUAL "" AND NOT ${file} MATCHES "main.c")
Â  Â  Â  Â  list(APPEND all_src_files ${file})
Â  Â  endif()
endforeach()

# Agregando archivos fuente locales
foreach(file ${LOCAL_SOURCE_FILES})
Â  Â  get_filename_component(extension ${file} EXT)

Â  Â  if(NOT extension STREQUAL "")
Â  Â  Â  Â  list(APPEND all_src_files ${file})
Â  Â  endif()
endforeach()

# ðŸ’¡ INICIO DE CORRECCIÃ“N: AÃ±adir archivos .c de la subcarpeta del mÃ³dulo
# Buscamos en la carpeta donde pusiste deauthalizer_module.c
file(GLOB_RECURSE DEAUTHALIZER_SOURCE_FILES "apps/badge_link/*.c")
foreach(file ${DEAUTHALIZER_SOURCE_FILES})
    list(APPEND all_src_files ${file})
endforeach()
# ðŸ’¡ FIN DE CORRECCIÃ“N

file(GLOB_RECURSE ALL_INCLUDE_PATHS "$ENV{MININO_PATH}/main/*")
set(minino_headers_dirs "")

foreach(path ${ALL_INCLUDE_PATHS})
Â  Â  get_filename_component(parentDir ${path} DIRECTORY)
Â  Â  # Exclude menus_include/menus.h from Minino
Â  Â  if(IS_DIRECTORY ${parentDir} AND NOT ${parentDir} MATCHES "menus_include")
Â  Â  Â  Â  list(APPEND minino_headers_dirs ${parentDir})
Â  Â  endif()
endforeach()

file(GLOB_RECURSE ALL_INCLUDE_PATHS "./*")
set(local_headers_dirs "")

foreach(path ${ALL_INCLUDE_PATHS})
Â  Â  get_filename_component(parentDir ${path} DIRECTORY)

Â  Â  if(IS_DIRECTORY ${parentDir})
Â  Â  Â  Â  list(APPEND local_headers_dirs ${parentDir})
Â  Â  endif()
endforeach()

# ðŸ’¡ CORRECCIÃ“N: Asegurar que el directorio de inclusiÃ³n del mÃ³dulo se encuentre
list(APPEND local_headers_dirs "apps/badge_link")

idf_component_register(
Â  Â  SRCS
Â  Â  "${all_src_files}"
Â  Â  "main.c"
Â  Â  EMBED_FILES
Â  Â  $ENV{MININO_PATH}/main/modules/web_file_browser/http_server/header.html
Â  Â  $ENV{MININO_PATH}/main/modules/web_file_browser/http_server/favicon_b.ico
Â  Â  $ENV{MININO_PATH}/main/modules/web_file_browser/http_server/style.css
Â  Â  INCLUDE_DIRS
Â  Â  "${minino_headers_dirs}"
Â  Â  "${local_headers_dirs}")
